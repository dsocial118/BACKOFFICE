{% comment %}
Componente de tabla para listado de archivos de ciudadanos
Parámetros:
- archivos: QuerySet o lista de archivos (requerido)
- ciudadano: Objeto ciudadano (requerido para botones)
- show_actions: Mostrar columna de acciones (default: True)
- table_class: Clases adicionales para la tabla (opcional)
- delete_js_function: Nombre función JS para eliminar (default: deleteArchivo)
{% endcomment %}

{% load static %}

<div class="row">
    <!-- Botones de acción -->
    <div class="col-12 my-3 mx-2 d-print-none">
        <a href="{% url 'ciudadanosarchivos_crear' ciudadano.id %}" class="btn btn-primary mr-1">
            <i class="fas fa-edit me-1"></i>Editar
        </a>
        <button type="button" class="btn btn-secondary mr-1 print">
            <i class="fas fa-print me-1"></i>Imprimir
        </button>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">
                    <i class="fas fa-folder-open me-2"></i>
                    Archivos del Ciudadano
                </h3>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-bordered table-hover {{ table_class|default:'tabladt' }}">
                        <thead class="table-dark">
                            <tr>
                                <th>Fecha</th>
                                <th>Nombre</th>
                                <th>Tipo</th>
                                <th>Tamaño</th>
                                {% if show_actions|default:True %}
                                <th style="width: 200px" class="notexport">Acciones</th>
                                {% endif %}
                            </tr>
                        </thead>
                        <tbody>
                            {% for archivo in archivos %}
                            <tr id="tr-{{ archivo.id }}">
                                <td>
                                    <small class="text-muted">
                                        <i class="fas fa-calendar me-1"></i>
                                        {{ archivo.fecha|date:"d/m/Y" }}
                                    </small>
                                </td>
                                <td>
                                    <div class="d-flex align-items-center">
                                        {% if archivo.tipo == 'Imagen' %}
                                            <i class="fas fa-image text-primary me-2"></i>
                                        {% else %}
                                            <i class="fas fa-file-alt text-info me-2"></i>
                                        {% endif %}
                                        <span>{{ archivo.archivo|cut:"ciudadanos/archivos/" }}</span>
                                    </div>
                                </td>
                                <td>
                                    {% if archivo.tipo == 'Imagen' %}
                                        <span class="badge bg-primary">
                                            <i class="fas fa-image me-1"></i>{{ archivo.tipo }}
                                        </span>
                                    {% else %}
                                        <span class="badge bg-info">
                                            <i class="fas fa-file-alt me-1"></i>{{ archivo.tipo }}
                                        </span>
                                    {% endif %}
                                </td>
                                <td>
                                    <small class="text-muted">
                                        <i class="fas fa-weight me-1"></i>
                                        {{ archivo.archivo.size|filesizeformat }}
                                    </small>
                                </td>
                                {% if show_actions|default:True %}
                                <td class="text-center">
                                    <div class="btn-group btn-group-sm" role="group">
                                        <a href="{{ MEDIA_URL }}{{ archivo.archivo.url }}"
                                           target="_blank"
                                           class="btn btn-outline-primary"
                                           title="Ver archivo">
                                            <i class="fas fa-eye"></i>
                                        </a>
                                        <a href="{{ MEDIA_URL }}{{ archivo.archivo.url }}"
                                           download
                                           class="btn btn-outline-success"
                                           title="Descargar archivo">
                                            <i class="fas fa-download"></i>
                                        </a>
                                        <button onclick='{{ delete_js_function|default:"deleteArchivo" }}("{{ archivo.id }}")'
                                                type="button"
                                                class="btn btn-outline-danger"
                                                title="Eliminar archivo">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                                {% endif %}
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="{% if show_actions|default:True %}5{% else %}4{% endif %}" class="text-center text-muted py-4">
                                    <i class="fas fa-folder-open fa-2x mb-2"></i>
                                    <br>No hay archivos disponibles
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Botón volver -->
<div class="row mt-4 d-print-none">
    <div class="col-12 mx-2">
        <a href="{% url 'ciudadanos_ver' ciudadano.id %}" class="btn btn-secondary">
            <i class="fas fa-arrow-left me-1"></i>Volver
        </a>
    </div>
</div>