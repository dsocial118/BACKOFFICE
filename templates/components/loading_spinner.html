{# Componente Loading Spinner #}
{# Uso: {% include 'components/loading_spinner.html' with type='border' message='Cargando...' size='sm' color='primary' %} #}

<div class="d-flex {% if center %}justify-content-center{% endif %} {% if vertical_center %}align-items-center{% endif %} {{ container_class|default:'' }}"
     {% if id %}id="{{ id }}"{% endif %}
     {% if hidden %}style="display: none;"{% endif %}>
     
    {% if type == 'grow' %}
        <div class="spinner-grow {% if color %}text-{{ color }}{% endif %} {% if size %}spinner-grow-{{ size }}{% endif %}" 
             role="status">
            <span class="visually-hidden">{{ sr_text|default:'Cargando...' }}</span>
        </div>
    {% elif type == 'dots' %}
        <div class="spinner-dots">
            <div class="dot1"></div>
            <div class="dot2"></div>
            <div class="dot3"></div>
        </div>
    {% elif type == 'pulse' %}
        <div class="spinner-pulse">
            <div class="rect1"></div>
            <div class="rect2"></div>
            <div class="rect3"></div>
            <div class="rect4"></div>
            <div class="rect5"></div>
        </div>
    {% else %}
        {# Default: border spinner #}
        <div class="spinner-border {% if color %}text-{{ color }}{% endif %} {% if size %}spinner-border-{{ size }}{% endif %}" 
             role="status">
            <span class="visually-hidden">{{ sr_text|default:'Cargando...' }}</span>
        </div>
    {% endif %}
    
    {% if message %}
        <span class="{% if message_class %}{{ message_class }}{% else %}ms-2{% endif %}">
            {{ message }}
        </span>
    {% endif %}
</div>

{# CSS personalizado para spinners adicionales #}
{% if type == 'dots' or type == 'pulse' %}
<style>
    {% if type == 'dots' %}
    .spinner-dots {
        width: 70px;
        text-align: center;
    }
    .spinner-dots > div {
        width: 18px;
        height: 18px;
        background-color: {% if color == 'primary' %}#007bff{% elif color == 'success' %}#28a745{% elif color == 'danger' %}#dc3545{% elif color == 'warning' %}#ffc107{% elif color == 'info' %}#17a2b8{% else %}#6c757d{% endif %};
        border-radius: 100%;  
        display: inline-block;
        animation: sk-bouncedelay 1.4s infinite ease-in-out both;
    }
    .spinner-dots .dot1 { animation-delay: -0.32s; }
    .spinner-dots .dot2 { animation-delay: -0.16s; }
    @keyframes sk-bouncedelay {
        0%, 80%, 100% { 
            transform: scale(0);
        } 40% { 
            transform: scale(1.0);
        }
    }
    {% endif %}
    
    {% if type == 'pulse' %}
    .spinner-pulse {
        width: 50px;
        height: 40px;
        text-align: center;
        font-size: 10px;
    }
    .spinner-pulse > div {
        background-color: {% if color == 'primary' %}#007bff{% elif color == 'success' %}#28a745{% elif color == 'danger' %}#dc3545{% elif color == 'warning' %}#ffc107{% elif color == 'info' %}#17a2b8{% else %}#6c757d{% endif %};
        height: 100%;
        width: 6px;
        display: inline-block;
        animation: sk-stretchdelay 1.2s infinite ease-in-out;
    }
    .spinner-pulse .rect2 { animation-delay: -1.1s; }
    .spinner-pulse .rect3 { animation-delay: -1.0s; }
    .spinner-pulse .rect4 { animation-delay: -0.9s; }
    .spinner-pulse .rect5 { animation-delay: -0.8s; }
    @keyframes sk-stretchdelay {
        0%, 40%, 100% { transform: scaleY(0.4); }  
        20% { transform: scaleY(1.0); }
    }
    {% endif %}
</style>
{% endif %}

{# Overlay completo opcional #}
{% if overlay %}
<div class="loading-overlay" {% if id %}id="{{ id }}_overlay"{% endif %} {% if hidden %}style="display: none;"{% endif %}>
    <div class="loading-overlay-content">
        <div class="spinner-border text-{{ color|default:'primary' }}" role="status">
            <span class="visually-hidden">{{ sr_text|default:'Cargando...' }}</span>
        </div>
        {% if message %}
            <div class="mt-3 text-{{ color|default:'primary' }}">{{ message }}</div>
        {% endif %}
    </div>
</div>
<style>
    .loading-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 9999;
        display: flex;
        justify-content: center;
        align-items: center;
    }
    .loading-overlay-content {
        text-align: center;
        color: white;
    }
</style>
{% endif %}