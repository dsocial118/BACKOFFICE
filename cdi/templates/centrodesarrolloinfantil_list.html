{% extends "includes/main.html" %}
{% load static custom_filters %}

{% block title %}Centro Desarrollo Infantil{% endblock %}

{% block breadcrumb %}
    {% include 'components/breadcrumb.html' with items=breadcrumb_items %}
{% endblock %}

{% block content %}
{% url 'cdi_ajax' as ajax_url %}

<!-- Variables para evitar problemas de formateo -->
{% with titulo_search='Buscar Centro Desarrollo Infantil' %}
{% with placeholder_text='Buscar por nombre, numero expediente, numero repi, organizacion, provincia, telefono o email' %}
{% with help_text='Ingresar nombre, CUIT, telefono o email.' %}
{% with reset_url_name='cdi' %}
{% with add_url_name='cdi_crear' %}
{% with tbody_id='cdi-table-body' %}

{% include 'components/search_bar.html' with titulo=titulo_search placeholder=placeholder_text help_text=help_text reset_url=reset_url_name add_url=add_url_name query=query add_text='Agregar' ajax_search_mode=True ajax_url=ajax_url target_tbody_id=tbody_id %}

{% endwith %}
{% endwith %}
{% endwith %}
{% endwith %}
{% endwith %}
{% endwith %}
<!-- CDI Data Table with AJAX -->
<div class="row mt-3">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-bordered table-striped projects">
                        <thead>
                            <tr>
                                {% for header in table_headers %}
                                    <th>{{ header.title }}</th>
                                {% endfor %}
                                {% if show_actions %}
                                    <th style="width: 15%" class="notexport">Acciones</th>
                                {% endif %}
                            </tr>
                        </thead>
                        <tbody id="cdi-table-body">
                            {% for item in centrodesarrolloinfantiles %}
                                <tr>
                                    {% for field in fields %}
                                        <td>
                                            {% if field.link_field %}
                                                <a href="{% url field.link_url item.pk %}"
                                                   {% if field.link_class %}class="{{ field.link_class }}"{% endif %}
                                                   {% if field.link_title %}title="{{ field.link_title }}"{% endif %}>
                                                    {{ item|getattr:field.name }}
                                                </a>
                                            {% else %}
                                                {{ item|getattr:field.name }}
                                            {% endif %}
                                        </td>
                                    {% endfor %}
                                    {% if show_actions %}
                                        <td class="project-actions text-right">
                                            {% if actions %}
                                                <div class="btn-group" role="group">
                                                    {% for action in actions %}
                                                        <a href="{% url action.url_name item.pk %}"
                                                           class="btn btn-{{ action.type|default:'primary' }} btn-sm {{ action.class|default:'' }}">
                                                            {{ action.label }}
                                                        </a>
                                                    {% endfor %}
                                                </div>
                                            {% endif %}
                                        </td>
                                    {% endif %}
                                </tr>
                            {% empty %}
                                <tr>
                                    <td colspan="{% if show_actions %}{{ table_headers|length|add:1 }}{% else %}{{ table_headers|length }}{% endif %}"
                                        class="text-center text-muted py-4">
                                        No hay centros de desarrollo infantil registrados.
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="pagination-container">
    {% if is_paginated %}
        {% include 'components/pagination.html' %}
    {% endif %}
</div>

{% endblock %}

{% block customJS %}{% endblock %}
