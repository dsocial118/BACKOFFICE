{% extends "includes/main.html" %}
{% load static %}

{% block title %}Organizacion: {{ organizacion.nombre }}{% endblock %}

{% block titulo-pagina %}
{{ organizacion.nombre }}
<span class="ml-2 h5">| {{ organizacion.cuit | default_if_none:"-" }}</span>
{% endblock %}

{% block breadcrumb %}
    {% include "components/navigation/breadcrumb.html" with 
       breadcrumb_items=breadcrumb_items 
       current_item=organizacion.nombre 
    %}
{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'custom/css/cardsDetail.css' %}" />
<link rel="stylesheet" href="{% static 'custom/css/comedorRelevamiento.css' %}" />

{% include "components/ui/detail_header_buttons.html" with 
   back_url='organizaciones' 
   edit_url='organizacion_editar' 
   delete_url='organizacion_eliminar' 
   object_id=organizacion.id 
   show_print=True 
%}

<div class="row organizacion-container">
  <div class="col-12">
    <div class="row">
      <div class="col-12">
        <!-- Card de Informaci贸n -->
        <div class="card card-informacion">
          <div class="card-header">
            <h3 class="card-title font-weight-bold mr-3 pt-1">Informaci贸n</h3>
            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
              </button>
            </div>
          </div>
          <div class="card-body card-comments p-0 pb-1">
            <div class="col-12">
              <div class="row">
                <div class="col-6">
                  <div class="nav-item d-flex">
                    <div class="comment-text comment-text d-flex flex-column">
                      Nombre
                      <span class="username">{{ organizacion.nombre }}</span>
                    </div>
                  </div>
                  <div class="nav-item d-flex">
                    <div class="comment-text comment-text d-flex flex-column">
                      CUIT
                      <span class="username">{{ organizacion.cuit | default_if_none:"-" }}</span>
                    </div>
                  </div>
                  <div class="nav-item d-flex">
                    <div class="comment-text comment-text d-flex flex-column">
                      Telefono
                      <span class="username">{{ organizacion.telefono | default_if_none:"-" }}</span>
                    </div>
                  </div>
                  <div class="nav-item d-flex">
                    <div class="comment-text comment-text d-flex flex-column">
                      Email
                      <span class="username">{{ organizacion.email | default_if_none:"-" }}</span>
                    </div>
                  </div>
                  <div class="nav-item d-flex">
                    <div class="comment-text comment-text d-flex flex-column">
                      Tipo Organizacion
                      <span class="username">{{ organizacion.tipo_entidad | default_if_none:"-" }}</span>
                    </div>
                  </div>
                  <div class="nav-item d-flex">
                    <div class="comment-text comment-text d-flex flex-column">
                      Subtipo Organizacion
                      <span class="username">{{ organizacion.subtipo_entidad | default_if_none:"-" }}</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Card de Firmantes -->
        <div class="card card-information mt-3">
          <div class="card-header">
            <h3 class="card-title font-weight-bold mr-3 pt-1">Firmantes</h3>
            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
              </button>
            </div>
          </div>
          <div class="card-body card-comments p-0 pb-1">
            {% if firmantes %}
            <table class="table table-striped table-bordered container my-3">
              <thead>
                <tr>
                  <th>Nombre</th>
                  <th>Rol</th>
                  <th>CUIT</th>
                </tr>
              </thead>
              <tbody>
                {% for firmante in firmantes %}
                <tr>
                  <td>{{ firmante.nombre }}</td>
                  <td>{{ firmante.rol.nombre }}</td>
                  <td>{{ firmante.cuit|default:"-" }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
            {% else %}
            <p>No hay firmantes asociados.</p>
            {% endif %}
          </div>
        </div>

        <!-- Cards de Avales (solo para Asociaci贸n de hecho) -->
        {% if organizacion.tipo_entidad.nombre == "Asociaci贸n de hecho" %}
        <div class="card card-information mt-3">
          <div class="card-header">
            <h3 class="card-title font-weight-bold mr-3 pt-1">Aval 1</h3>
            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
              </button>
            </div>
          </div>
          <div class="card-body card-comments p-0 pb-1">
            {% if avales1 %}
            <table class="table table-striped table-bordered container my-3">
              <thead>
                <tr>
                  <th>Nombre</th>
                  <th>CUIT</th>
                </tr>
              </thead>
              <tbody>
                {% for aval in avales1 %}
                <tr>
                  <td>{{ aval.nombre }}</td>
                  <td>{{ aval.cuit|default:"-" }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
            {% else %}
            <p>No hay avales 1 asociados.</p>
            {% endif %}
          </div>
        </div>

        <div class="card card-information mt-3">
          <div class="card-header">
            <h3 class="card-title font-weight-bold mr-3 pt-1">Aval 2</h3>
            <div class="card-tools">
              <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
              </button>
            </div>
          </div>
          <div class="card-body card-comments p-0 pb-1">
            {% if avales2 %}
            <table class="table table-striped table-bordered container my-3">
              <thead>
                <tr>
                  <th>Nombre</th>
                  <th>CUIT</th>
                </tr>
              </thead>
              <tbody>
                {% for aval in avales2 %}
                <tr>
                  <td>{{ aval.nombre }}</td>
                  <td>{{ aval.cuit|default:"-" }}</td>
                </tr>
                {% endfor %}
              </tbody>
            </table>
            {% else %}
            <p>No hay avales 2 asociados.</p>
            {% endif %}
          </div>
        </div>
        {% endif %}

      </div>
    </div>
  </div>
</div>
{% endblock %}