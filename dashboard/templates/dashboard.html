{% extends "includes/main.html" %}
{% load static custom_filters %}

{% block head %}
    {{ block.super }}
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/charts.css/dist/charts.min.css" />
    <link rel="stylesheet" href="{% static 'custom/css/dashboard.css' %}" />
{% endblock %}

{% block title %}Dashboard{% endblock %}
{% block titulo-pagina %}Dashboard{% endblock %}
{% block breadcrumb %}{% endblock %}
{% block menu-adicional %}{% endblock %}

{% block content %}
    {# Bloque SSE: sólo indicadores nuevos #}
    {% if request.user|has_group:"Dashboard Centrodefamilia" %}
        <div class="row mb-4">
            <div class="col-3">
                <div class="custom-card card-blue">
                    <div class="card-icon"><i class="fas fa-user-friends"></i></div>
                    <div class="card-content">
                        <div class="card-amount">{{ participantes_total }}</div>
                        <div class="card-title">Participantes Totales</div>
                    </div>
                </div>
            </div>
            <div class="col-3">
                <div class="custom-card card-orange">
                    <div class="card-icon"><i class="fas fa-building"></i></div>
                    <div class="card-content">
                        <div class="card-amount">{{ centros_adheridos_totales }}</div>
                        <div class="card-title">Centros Adheridos</div>
                    </div>
                </div>
            </div>
            <div class="col-3">
                <div class="custom-card card-purple">
                    <div class="card-icon"><i class="fas fa-lightbulb"></i></div>
                    <div class="card-content">
                        <div class="card-amount">{{ centros_faro_totales }}</div>
                        <div class="card-title">Centros Faro</div>
                    </div>
                </div>
            </div>
            <div class="col-3">
                <div class="custom-card card-yellow">
                    <div class="card-icon"><i class="fas fa-tasks"></i></div>
                    <div class="card-content">
                        <div class="card-amount">{{ actividades_totales }}</div>
                        <div class="card-title">Actividades Totales</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
    <div class="container">
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Datos de Comedores</h3>
                <div class="card-tools">
                    <button type="button" class="btn btn-tool" data-card-widget="collapse">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            </div>
            <div class="card-body p-0">
                <div class="row">
                    <div class="col-12 text-center">
                        <div class="embed-responsive embed-responsive-16by9 text-center">
                            <iframe class="embed-responsive-item" title="Tablero - Comedores" src="https://app.powerbi.com/reportEmbed?reportId=35d6f754-ce1d-48b8-a463-3ba9f3ac6d70&autoAuth=true&ctid=4f822cf4-6867-43fa-ae4a-03a39fe9309c" frameborder="0" allowfullscreen></iframe>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
        </div>
    {% elif request.user|has_group:"Dashboard Comedor"%}
        <div class="row mb-4">
            <div class="col-4">
                <div class="custom-card card-violet">
                    <div class="card-icon"><i class="fas fa-utensils"></i></div>
                    <div class="card-content">
                        <div class="card-amount">{{ cantidad_comedores_activos }}</div>
                        <div class="card-title">Comedores Activos</div>
                    </div>
                </div>
            </div>
            <div class="col-4">
                <div class="custom-card card-red">
                    <div class="card-icon"><i class="fas fa-clipboard-check"></i></div>
                    <div class="card-content">
                        <div class="card-amount">{{ cantidad_relevamientos_activos }}</div>
                        <div class="card-title">Relevamientos Activos</div>
                    </div>
                </div>
            </div>
            <div class="col-4">
                <div class="custom-card card-green">
                    <div class="card-icon"><i class="fas fa-users"></i></div>
                    <div class="card-content">
                        <div class="card-amount">0</div>
                        <div class="card-title">Beneficiarios</div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-9">
                <div class="embed-responsive embed-responsive-16by9 w-100">
                    <iframe class="embed-responsive-item" title="Tablero - Comedores" src="https://app.powerbi.com/reportEmbed?reportId=35d6f754-ce1d-48b8-a463-3ba9f3ac6d70&autoAuth=true&ctid=4f822cf4-6867-43fa-ae4a-03a39fe9309c" allowfullscreen></iframe>
                </div>
            </div>
            <div class="col-md-3">
                <div class="custom-card mb-2">
                    <div class="card-icon"><i class="fas fa-users"></i></div>
                    <div class="card-content">
                        <div class="card-title">Duplas</div>
                        <div class="card-amount">{{ presupuesto_desayuno }}</div>
                    </div>
                </div>
                <div class="custom-card mb-2">
                    <div class="card-icon"><i class="fas fa-coffee"></i></div>
                    <div class="card-content">
                        <div class="card-title">Presupuesto Desayuno</div>
                        <div class="card-amount">${{ presupuesto_desayuno }}</div>
                    </div>
                </div>
                <div class="custom-card mb-2">
                    <div class="card-icon"><i class="fas fa-cookie"></i></div>
                    <div class="card-content">
                        <div class="card-title">Presupuesto Merienda</div>
                        <div class="card-amount">${{ presupuesto_merienda }}</div>
                    </div>
                </div>
                <div class="custom-card mb-2">
                    <div class="card-icon"><i class="fas fa-utensils"></i></div>
                    <div class="card-content">
                        <div class="card-title">Presupuesto Comida</div>
                        <div class="card-amount">${{ presupuesto_comida }}</div>
                    </div>
                </div>
            </div>
        </div>
            {% else %}
        <div class="d-flex justify-content-center align-items-center"
             style="height: 70vh">
            <img src="{% static 'custom/img/sisoc_logo.png' %}"
                 class="img-fluid"
                 alt="Capacitación Humano" />
        </div>
    {% endif %}
{% endblock %}
