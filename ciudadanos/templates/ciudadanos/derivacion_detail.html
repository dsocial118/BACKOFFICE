{% extends "includes/main.html" %} {% load static %} {% block head %}
<link
  rel="stylesheet"
  href="{% static 'custom/css/ciudadano-detail-enhanced.css' %}"
/>
<style>
  /* Sistema de CSS Variables para Detalle de Derivación */
  :root {
    --gov-primary: #143570;
    --gov-accent: #17a2b8;
    --gov-danger: #dc3545;
    --success: #28a745;
    --warning: #ffc107;
    --info: #17a2b8;
    --secondary: #6c757d;
  }

  /* Botones de acción mejorados */
  .action-buttons-section {
    background: rgba(255, 255, 255, 0.03);
    border-radius: 12px;
    padding: 1.5rem;
    margin-bottom: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  .btn-action-primary {
    background: linear-gradient(
      135deg,
      var(--gov-primary),
      var(--gov-accent)
    ) !important;
    border: none !important;
    border-radius: 8px !important;
    padding: 0.5rem 1rem !important;
    font-weight: 600;
    transition: all 0.3s ease;
    color: white !important;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    margin-right: 0.5rem;
  }

  .btn-action-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(20, 55, 107, 0.4);
    color: white !important;
  }

  .btn-action-secondary {
    background: linear-gradient(135deg, var(--secondary), #6c757d) !important;
    border: none !important;
    border-radius: 8px !important;
    padding: 0.5rem 1rem !important;
    font-weight: 600;
    transition: all 0.3s ease;
    color: white !important;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    margin-right: 0.5rem;
  }

  .btn-action-secondary:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(108, 117, 125, 0.4);
    color: white !important;
  }

  .btn-action-danger {
    background: linear-gradient(135deg, var(--gov-danger), #e74c3c) !important;
    border: none !important;
    border-radius: 8px !important;
    padding: 0.5rem 1rem !important;
    font-weight: 600;
    transition: all 0.3s ease;
    color: white !important;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    margin-right: 0.5rem;
  }

  .btn-action-danger:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(220, 53, 69, 0.4);
    color: white !important;
  }

  /* Cards de información mejoradas */
  .detail-card-enhanced {
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    margin-bottom: 1.5rem;
    transition: all 0.3s ease;
    backdrop-filter: blur(10px);
    overflow: hidden;
  }

  .detail-card-enhanced:hover {
    transform: translateY(-3px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    border-color: rgba(23, 162, 184, 0.3);
  }

  .detail-card-header {
    background: linear-gradient(135deg, var(--gov-primary), var(--gov-accent));
    color: white;
    padding: 1rem 1.5rem;
    border-radius: 12px 12px 0 0;
    margin: 0;
  }

  .detail-card-header h5 {
    margin: 0;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .detail-card-body {
    padding: 1.5rem;
  }

  /* Lista de detalles mejorada */
  .detail-list {
    margin: 0;
  }

  .detail-list dt {
    color: rgba(255, 255, 255, 0.7);
    font-weight: 500;
    margin-bottom: 0.5rem;
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .detail-list dd {
    color: white;
    font-weight: 600;
    margin-bottom: 1rem;
    font-size: 1rem;
  }

  .detail-list dd:last-child {
    margin-bottom: 0;
  }

  /* Badges mejorados */
  .status-badge {
    padding: 0.5rem 1rem;
    border-radius: 8px;
    font-weight: 600;
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }

  .status-pendiente {
    background: linear-gradient(135deg, var(--warning), #ffca2c);
    color: #333;
  }

  .status-aceptada {
    background: linear-gradient(135deg, var(--success), #20c997);
    color: white;
  }

  .status-rechazada {
    background: linear-gradient(135deg, var(--gov-danger), #e74c3c);
    color: white;
  }

  .importancia-badge {
    background: linear-gradient(135deg, var(--info), #0dcaf0);
    color: white;
    padding: 0.375rem 0.75rem;
    border-radius: 6px;
    font-weight: 600;
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  /* Enlaces mejorados */
  .enhanced-link {
    color: var(--gov-accent);
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s ease;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }

  .enhanced-link:hover {
    color: #0dcaf0;
    text-decoration: none;
    transform: translateX(3px);
  }

  /* Archivos adjuntos */
  .attachment-link {
    background: rgba(23, 162, 184, 0.1);
    border: 1px solid rgba(23, 162, 184, 0.3);
    border-radius: 8px;
    padding: 0.75rem 1rem;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--gov-accent);
    text-decoration: none;
    transition: all 0.3s ease;
    font-weight: 500;
  }

  .attachment-link:hover {
    background: rgba(23, 162, 184, 0.2);
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(23, 162, 184, 0.3);
    color: #0dcaf0;
    text-decoration: none;
  }

  /* Sección de rechazo */
  .rejection-section {
    background: rgba(220, 53, 69, 0.1);
    border: 1px solid rgba(220, 53, 69, 0.3);
    border-radius: 8px;
    padding: 1rem;
    margin-top: 1rem;
  }

  .rejection-title {
    color: var(--gov-danger);
    font-weight: 600;
    margin-bottom: 1rem;
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  /* Botón de volver mejorado */
  .btn-back-enhanced {
    background: linear-gradient(135deg, var(--secondary), #6c757d) !important;
    border: none !important;
    border-radius: 12px !important;
    padding: 0.75rem 1.5rem !important;
    font-weight: 600;
    transition: all 0.3s ease;
    color: white !important;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
  }

  .btn-back-enhanced:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(108, 117, 125, 0.4);
    color: white !important;
  }

  /* Animaciones de entrada */
  .fade-in-up {
    animation: fadeInUp 0.6s ease-out forwards;
  }

  .fade-in-left {
    animation: fadeInLeft 0.6s ease-out forwards;
  }

  .fade-in-right {
    animation: fadeInRight 0.6s ease-out forwards;
  }

  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes fadeInLeft {
    from {
      opacity: 0;
      transform: translateX(-30px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes fadeInRight {
    from {
      opacity: 0;
      transform: translateX(30px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  /* Responsividad */
  @media (max-width: 768px) {
    .action-buttons-section {
      padding: 1rem;
    }

    .detail-card-body {
      padding: 1rem;
    }

    .detail-list dt,
    .detail-list dd {
      font-size: 0.875rem;
    }

    .btn-action-primary,
    .btn-action-secondary,
    .btn-action-danger {
      padding: 0.5rem 0.75rem !important;
      font-size: 0.875rem;
      margin-bottom: 0.5rem;
    }
  }
</style>
{% endblock %} {% block title %}Detalle de Derivación - {{
object.ciudadano.nombre }} {{ object.ciudadano.apellido }}{% endblock %} {%
block titulo-pagina %}Ciudadano{% endblock %} {% block breadcrumb %}
<ol class="breadcrumb float-sm-right mt-2 mr-2">
  <li class="breadcrumb-item">
    <a href="{% url 'ciudadanos' %}">Ciudadano</a>
  </li>
  <li class="breadcrumb-item">
    <a href="{% url 'ciudadanos_ver' object.ciudadano.id %}"
      >{{ object.ciudadano.apellido }}, {{ object.ciudadano.nombre }}</a
    >
  </li>
  <li class="breadcrumb-item">
    <a href="{% url 'ciudadanosderivaciones_historial' object.ciudadano.id %}"
      >Derivaciones</a
    >
  </li>
  <li class="breadcrumb-item active">Detalle</li>
</ol>
{% endblock %} ; {% block menu-adicional %}{% endblock %} {% block content %}
<div class="row">
  <div class="col-md-12">
    <div class="card shadow-lg">
      <div class="card-body p-4">
        <!-- Botones de acción -->
        <div class="row mb-4 fade-in-up">
          <div class="col-12">
            <div class="action-buttons-section">
              <div
                class="d-flex justify-content-between align-items-center flex-wrap"
              >
                <h6 class="text-white mb-0">
                  <i class="fas fa-cogs me-2"></i>Acciones de Derivación
                </h6>
                <div class="action-buttons d-flex flex-wrap">
                  {% if request.user.id == object.usuario.id and object.estado
                  == 'Pendiente' %}
                  <a
                    href="{% url 'ciudadanosderivaciones_editar' object.id %}"
                    class="btn-action-primary"
                  >
                    <i class="fas fa-edit"></i>Editar
                  </a>
                  {% endif %}
                  <button onclick="window.print()" class="btn-action-secondary">
                    <i class="fas fa-print"></i>Imprimir
                  </button>
                  {% if request.user.id == object.usuario.id and object.estado
                  == 'Pendiente' %}
                  <a
                    href="{% url 'ciudadanosderivaciones_eliminar' object.id %}"
                    class="btn-action-danger"
                    onclick="return confirm('¿Está seguro de que desea eliminar esta derivación?')"
                  >
                    <i class="fas fa-trash"></i>Eliminar
                  </a>
                  {% endif %}
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Resumen del ciudadano -->
        <div class="row mb-4 fade-in-up">
          <div class="col-md-4">
            {% include "components/ciudadanos/ciudadano_summary_card.html" with
            ciudadano=object.ciudadano card_class="mb-0" %}
          </div>
          <div class="col-md-8">
            {% include "components/ciudadanos/derivacion_info_cards.html" with
            derivacion=object show_estado=True show_fechas=True
            show_asignacion=True %}
          </div>
        </div>

        <!-- Detalles de la derivación -->
        <div class="row fade-in-left">
          <div class="col-md-6">
            <div class="detail-card-enhanced">
              <div class="detail-card-header">
                <h5>
                  <i class="fas fa-share-alt"></i>Información de la Derivación
                </h5>
              </div>
              <div class="detail-card-body">
                <dl class="detail-list">
                  <dt>Fecha de solicitud</dt>
                  <dd>
                    <i class="fas fa-calendar-alt me-2 text-info"></i>
                    {{ object.fecha_creado|date:"d/m/Y" }}
                  </dd>

                  <dt>Estado actual</dt>
                  <dd>
                    {% if object.estado == "Pendiente" %}
                    <span class="status-badge status-pendiente">
                      <i class="far fa-clock"></i>{{ object.estado }}
                    </span>
                    {% elif object.estado == "Aceptada" %}
                    <span class="status-badge status-aceptada">
                      <i class="fas fa-check-circle"></i>{{ object.estado }}
                    </span>
                    {% elif object.estado == "Rechazada" %}
                    <span class="status-badge status-rechazada">
                      <i class="fas fa-times-circle"></i>{{ object.estado }}
                    </span>
                    {% endif %}
                  </dd>

                  <dt>Nivel de importancia</dt>
                  <dd>
                    <span class="importancia-badge">
                      <i class="fas fa-flag me-1"></i>{{ object.importancia }}
                    </span>
                  </dd>

                  {% if object.alertas.all.count %}
                  <dt>Alertas detectadas</dt>
                  <dd>
                    {% for alerta in object.alertas.all %}
                    <span class="badge bg-warning text-dark me-1">
                      <i class="fas fa-exclamation-triangle me-1"></i>{{ alerta
                      }}
                    </span>
                    {% endfor %}
                  </dd>
                  {% endif %}

                  <dt>Programa origen</dt>
                  <dd>
                    <i class="fas fa-arrow-right me-2 text-primary"></i>
                    {{ object.programa_solicitante }}
                  </dd>

                  <dt>Programa destino</dt>
                  <dd>
                    <i class="fas fa-arrow-left me-2 text-success"></i>
                    {{ object.programa }}
                  </dd>

                  {% if object.organismo %}
                  <dt>Organismo relacionado</dt>
                  <dd>
                    <i class="fas fa-building me-2 text-secondary"></i>
                    {{ object.organismo }}
                  </dd>
                  {% endif %} {% if object.detalles %}
                  <dt>Observaciones</dt>
                  <dd>
                    <i class="fas fa-comment-alt me-2 text-info"></i>
                    {{ object.detalles }}
                  </dd>
                  {% endif %} {% if object.archivos %}
                  <dt>Archivo adjunto</dt>
                  <dd>
                    <a
                      href="{{ object.archivos.url }}"
                      target="_blank"
                      class="attachment-link"
                    >
                      <i class="fas fa-paperclip"></i>
                      {{ object.archivos.name|cut:'ciudadanos/archivos/' }}
                      <i class="fas fa-external-link-alt ms-1"></i>
                    </a>
                  </dd>
                  {% endif %}
                </dl>

                <!-- Información de rechazo si aplica -->
                {% if object.estado == "Rechazada" %}
                <div class="rejection-section">
                  <div class="rejection-title">
                    <i class="fas fa-times-circle"></i>
                    Información del Rechazo
                  </div>
                  <dl class="detail-list mb-0">
                    <dt>Fecha de rechazo</dt>
                    <dd>
                      <i class="fas fa-calendar-times me-2 text-danger"></i>
                      {{ object.fecha_rechazo|date:"d/m/Y" }}
                    </dd>
                    <dt>Motivo del rechazo</dt>
                    <dd>
                      <i class="fas fa-exclamation-circle me-2 text-danger"></i>
                      {{ object.motivo_rechazo }}
                    </dd>
                    {% if object.obs_rechazo %}
                    <dt>Observaciones del rechazo</dt>
                    <dd>
                      <i class="fas fa-comment me-2 text-danger"></i>
                      {{ object.obs_rechazo }}
                    </dd>
                    {% endif %}
                  </dl>
                </div>
                {% endif %}
              </div>
            </div>
          </div>

          <div class="col-md-6">
            <div class="detail-card-enhanced">
              <div class="detail-card-header">
                <h5><i class="fas fa-user"></i>Datos del Solicitante</h5>
              </div>
              <div class="detail-card-body">
                <dl class="detail-list">
                  <dt>Usuario que solicitó</dt>
                  <dd>
                    <i class="fas fa-user-tie me-2 text-primary"></i>
                    {{
                    object.usuario.get_full_name|default:object.usuario.username
                    }}
                  </dd>

                  {% if object.usuario.usuarios.telefono %}
                  <dt>Teléfono del usuario</dt>
                  <dd>
                    <i class="fas fa-phone me-2 text-success"></i>
                    <a
                      href="tel:{{ object.usuario.usuarios.telefono }}"
                      class="enhanced-link"
                    >
                      {{ object.usuario.usuarios.telefono }}
                      <i class="fas fa-phone"></i>
                    </a>
                  </dd>
                  {% endif %}

                  <dt>Email del usuario</dt>
                  <dd>
                    <i class="fas fa-envelope me-2 text-info"></i>
                    <a
                      href="mailto:{{ object.usuario.email }}"
                      class="enhanced-link"
                    >
                      {{ object.usuario.email }}
                      <i class="fas fa-envelope"></i>
                    </a>
                  </dd>
                </dl>

                <div
                  class="alert alert-info border-0 mt-3"
                  style="background: rgba(23, 162, 184, 0.1)"
                >
                  <i class="fas fa-info-circle me-2"></i>
                  <strong>Información:</strong> Puede contactar al usuario que
                  realizó la solicitud de derivación para obtener más detalles.
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Botón de volver -->
        <div class="row mt-4 fade-in-up">
          <div class="col-12">
            <div class="d-flex justify-content-between">
              <a
                href="{% url 'ciudadanosderivaciones_historial' object.ciudadano.id %}"
                class="btn-back-enhanced"
              >
                <i class="fas fa-arrow-left"></i>Volver al Historial
              </a>
              <div class="action-buttons d-flex">
                {% if request.user.id == object.usuario.id and object.estado ==
                'Pendiente' %}
                <a
                  href="{% url 'ciudadanosderivaciones_editar' object.id %}"
                  class="btn-action-primary"
                >
                  <i class="fas fa-edit"></i>Editar Derivación
                </a>
                {% endif %}
                <a
                  href="{% url 'ciudadanos_ver' object.ciudadano.id %}"
                  class="btn-action-secondary"
                >
                  <i class="fas fa-user"></i>Ver Ciudadano
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %} ; {% block customJS %}
<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Aplicar animaciones de entrada escalonadas
    const animatedElements = document.querySelectorAll(
      ".fade-in-up, .fade-in-left, .fade-in-right"
    );
    animatedElements.forEach((element, index) => {
      element.style.opacity = "0";
      element.style.transform = element.classList.contains("fade-in-left")
        ? "translateX(-30px)"
        : element.classList.contains("fade-in-right")
        ? "translateX(30px)"
        : "translateY(30px)";

      setTimeout(() => {
        element.style.transition = "all 0.6s ease-out";
        element.style.opacity = "1";
        element.style.transform = "translate(0, 0)";
      }, index * 200);
    });

    // Efectos hover mejorados para cards
    const detailCards = document.querySelectorAll(".detail-card-enhanced");
    detailCards.forEach((card) => {
      card.addEventListener("mouseenter", function () {
        this.style.transform = "translateY(-5px) scale(1.02)";
        this.style.boxShadow = "0 12px 30px rgba(0, 0, 0, 0.3)";
      });

      card.addEventListener("mouseleave", function () {
        this.style.transform = "translateY(0) scale(1)";
        this.style.boxShadow = "0 8px 25px rgba(0, 0, 0, 0.2)";
      });
    });

    // Efectos para botones de acción
    const actionButtons = document.querySelectorAll(
      ".btn-action-primary, .btn-action-secondary, .btn-action-danger, .btn-back-enhanced"
    );
    actionButtons.forEach((button) => {
      button.addEventListener("mouseenter", function () {
        this.style.transform = "translateY(-3px) scale(1.05)";
      });

      button.addEventListener("mouseleave", function () {
        this.style.transform = "translateY(0) scale(1)";
      });

      button.addEventListener("click", function () {
        this.style.transform = "translateY(1px) scale(0.98)";
        setTimeout(() => {
          this.style.transform = "translateY(0) scale(1)";
        }, 100);
      });
    });

    // Efectos para enlaces mejorados
    const enhancedLinks = document.querySelectorAll(".enhanced-link");
    enhancedLinks.forEach((link) => {
      link.addEventListener("mouseenter", function () {
        this.style.transform = "translateX(5px) scale(1.05)";
      });

      link.addEventListener("mouseleave", function () {
        this.style.transform = "translateX(0) scale(1)";
      });
    });

    // Efectos para badges de estado
    const statusBadges = document.querySelectorAll(".status-badge");
    statusBadges.forEach((badge) => {
      badge.addEventListener("click", function () {
        this.style.transform = "scale(0.95)";
        setTimeout(() => {
          this.style.transform = "scale(1)";
        }, 100);
      });

      // Efecto de pulso para estados pendientes
      if (badge.classList.contains("status-pendiente")) {
        setInterval(() => {
          badge.style.transform = "scale(1.05)";
          setTimeout(() => {
            badge.style.transform = "scale(1)";
          }, 200);
        }, 3000);
      }
    });

    // Función para mostrar notificaciones
    window.showNotification = function (message, type = "info") {
      const alertClass =
        type === "success"
          ? "alert-success"
          : type === "error"
          ? "alert-danger"
          : type === "warning"
          ? "alert-warning"
          : "alert-info";

      const iconClass =
        type === "success"
          ? "fas fa-check-circle"
          : type === "error"
          ? "fas fa-exclamation-triangle"
          : type === "warning"
          ? "fas fa-exclamation-circle"
          : "fas fa-info-circle";

      const notification = document.createElement("div");
      notification.className = `alert ${alertClass} alert-dismissible fade show position-fixed`;
      notification.style.cssText =
        "top: 20px; right: 20px; z-index: 10000; min-width: 350px; backdrop-filter: blur(10px);";
      notification.innerHTML = `
                <i class="${iconClass} me-2"></i>${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;

      document.body.appendChild(notification);

      // Auto-remover después de 5 segundos
      setTimeout(() => {
        if (notification.parentNode) {
          notification.remove();
        }
      }, 5000);
    };

    // Configurar funcionalidad de impresión
    const printButton = document.querySelector(
      'button[onclick="window.print()"]'
    );
    if (printButton) {
      printButton.addEventListener("click", function () {
        // Añadir clase para estilos de impresión
        document.body.classList.add("printing");

        // Mostrar notificación
        showNotification("Preparando documento para impresión...", "info");

        setTimeout(() => {
          window.print();
          document.body.classList.remove("printing");
        }, 500);
      });
    }

    // Efectos para enlaces de archivos adjuntos
    const attachmentLinks = document.querySelectorAll(".attachment-link");
    attachmentLinks.forEach((link) => {
      link.addEventListener("mouseenter", function () {
        this.style.transform = "translateY(-3px) scale(1.02)";
      });

      link.addEventListener("mouseleave", function () {
        this.style.transform = "translateY(0) scale(1)";
      });

      link.addEventListener("click", function () {
        showNotification("Abriendo archivo adjunto...", "info");
      });
    });

    // Animación para la sección de rechazo si existe
    const rejectionSection = document.querySelector(".rejection-section");
    if (rejectionSection) {
      rejectionSection.style.opacity = "0";
      rejectionSection.style.transform = "translateY(20px)";

      setTimeout(() => {
        rejectionSection.style.transition = "all 0.6s ease-out";
        rejectionSection.style.opacity = "1";
        rejectionSection.style.transform = "translateY(0)";
      }, 1000);
    }

    // Funcionalidad de confirmación para acciones peligrosas
    const dangerButtons = document.querySelectorAll(".btn-action-danger");
    dangerButtons.forEach((button) => {
      button.addEventListener("click", function (e) {
        const confirmed = confirm(
          "¿Está seguro de que desea realizar esta acción? Esta operación no se puede deshacer."
        );
        if (!confirmed) {
          e.preventDefault();
          return false;
        }
      });
    });

    // Efecto de carga completa
    setTimeout(() => {
      const mainCard = document.querySelector(".card.shadow-lg");
      if (mainCard) {
        mainCard.style.opacity = "0";
        mainCard.style.transform = "translateY(20px)";
        mainCard.style.transition = "all 0.8s ease-out";

        setTimeout(() => {
          mainCard.style.opacity = "1";
          mainCard.style.transform = "translateY(0)";
        }, 100);
      }
    }, 100);

    // Funcionalidad para copiar información al portapapeles
    window.copyToClipboard = function (
      text,
      message = "Información copiada al portapapeles"
    ) {
      navigator.clipboard
        .writeText(text)
        .then(() => {
          showNotification(message, "success");
        })
        .catch(() => {
          showNotification("Error al copiar información", "error");
        });
    };

    // Agregar funcionalidad de clic para copiar información importante
    const copyableElements = document.querySelectorAll("[data-copyable]");
    copyableElements.forEach((element) => {
      element.style.cursor = "pointer";
      element.title = "Clic para copiar";

      element.addEventListener("click", function () {
        const text = this.textContent.trim();
        copyToClipboard(
          text,
          `${this.getAttribute("data-copy-label") || "Información"} copiada`
        );
      });
    });

    // Efectos de scroll suave para enlaces internos
    const internalLinks = document.querySelectorAll('a[href^="#"]');
    internalLinks.forEach((link) => {
      link.addEventListener("click", function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute("href"));
        if (target) {
          target.scrollIntoView({
            behavior: "smooth",
            block: "start",
          });
        }
      });
    });

    // Sistema de tooltips mejorado
    const elementsWithTooltips = document.querySelectorAll("[title]");
    elementsWithTooltips.forEach((element) => {
      element.addEventListener("mouseenter", function () {
        this.style.position = "relative";
      });
    });

    // Animación de contadores si hay elementos numéricos
    const numericElements = document.querySelectorAll("[data-counter]");
    numericElements.forEach((element) => {
      const target = parseInt(element.getAttribute("data-counter"));
      let current = 0;
      const increment = target / 30;

      const updateCounter = () => {
        if (current < target) {
          current += increment;
          element.textContent = Math.floor(current);
          requestAnimationFrame(updateCounter);
        } else {
          element.textContent = target;
        }
      };

      setTimeout(() => {
        updateCounter();
      }, 1500);
    });
  });

  // Estilos de impresión
  const printStyles = `
        @media print {
            .action-buttons-section,
            .btn-back-enhanced,
            .action-buttons {
                display: none !important;
            }
            
            .detail-card-enhanced {
                break-inside: avoid;
                box-shadow: none !important;
                border: 1px solid #ddd !important;
            }
            
            .detail-card-header {
                background: #f8f9fa !important;
                color: #333 !important;
            }
            
            body {
                background: white !important;
                color: #333 !important;
            }
        }
    `;

  // Agregar estilos de impresión
  const styleSheet = document.createElement("style");
  styleSheet.textContent = printStyles;
  document.head.appendChild(styleSheet);
</script>
{% endblock %}
